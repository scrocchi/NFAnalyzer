"use strict";function setAcceptNode(t,e){var a=e.part,o=t.diagram;o.startTransaction("Set Accept");var n=a.adornedPart,r=n.data;r.accept?(o.model.setDataProperty(r,"accept",!1),o.model.setDataProperty(r,"text",r.text.slice(0,-2))):(o.model.setDataProperty(r,"accept",!0),o.model.setDataProperty(r,"text",r.text+" †")),o.commitTransaction("Set Accept")}function setEntryNode(t,e){var a=e.part,o=t.diagram;o.startTransaction("Set Entry");var n=a.adornedPart,r=n.data;r.entry?(o.model.setDataProperty(r,"entry",!1),o.model.setDataProperty(r,"text",r.text.substr(2))):(o.model.setDataProperty(r,"entry",!0),o.model.setDataProperty(r,"text","► "+r.text)),o.commitTransaction("Set Entry")}function addNodeAndLink(t,e){var a=e.part,o=t.diagram;o.startTransaction("Add State");var n=a.adornedPart,r=n.data,i=o.model,l={key:keyManage+1,text:"q"+(keyManage+1),entry:!1,accept:!1};keyManage++;var c=n.location.copy();c.x+=200,l.loc=go.Point.stringify(c);var i=o.model;i.addNodeData(l);var s={from:i.getKeyForNodeData(r),to:i.getKeyForNodeData(l),text:"?"};i.addLinkData(s);var d=o.findNodeForData(l);o.select(d),o.commitTransaction("Add State"),o.scrollToRect(d.actualBounds)}function save(){document.getElementById("mySavedModel").value=myDiagram.model.toJson()}function load(){myDiagram.model=go.Model.fromJson(document.getElementById("mySavedModel").value)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function run(t){var e=Object.values(myDiagram.model.nodeDataArray),a=Object.values(myDiagram.model.linkDataArray),o=[];for(var n in e)if(e.hasOwnProperty(n)){o[n]=new Nodos(e[n].key,e[n].text,e[n].entry,e[n].accept);for(var r in a)if(a.hasOwnProperty(r)&&a[r].from==e[n].key){var i=new Enlaces(a[r].from,a[r].to,a[r].text);o[n].addEnlace(i)}}checkModel(o)&&(output.clear(),t.forEach(function(t){testWord(o,t)}))}function testWord(t,e){var a,o=!1;t.forEach(function(n){n.entry&&(checkNextNode(t,n,e,"",e)?(o=!0,a=e):a=e)}),o?output.addWord(a,!0,""):output.addWord(a,!1,"")}function checkNextNode(t,e,a,o,n){var r=!1,i=a.charAt(0);if(a.length>0&&e.enlaces){e.enlaces.forEach(function(l){l.text==i&&(o+=e.text+"-"+l.text+"->",r?checkNextNode(t,findNodeByKey(t,l.to),a.substr(1),o,n):r=checkNextNode(t,findNodeByKey(t,l.to),a.substr(1),o,n))})}else{if(0!=a.length)return!1;if(e.accept)return o+=e.text,!0}return r}function findNodeByKey(t,e){var a;return t.forEach(function(t){t.key==e&&(a=t)}),a}function checkModel(t){var e=!0,a=!1,o=!1;return t.forEach(function(t){a=!(a||!t.entry)||a,o=!(o||!t.accept)||o,t.enlaces.forEach(function(t){e=!(!t.text||"?"==t.text)&&e})}),!!(a&&e&&o)||(a||output.showError("At least one entry node must be defined, Check the model."),o||output.showError("At least one accepted node must be defined, Check the model."),e||output.showError("Undefined transitions. Check the model."),!1)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var $=go.GraphObject.make,myDiagram=$(go.Diagram,"paper",{initialContentAlignment:go.Spot.Center,"toolManager.mouseWheelBehavior":go.ToolManager.WheelZoom,"undoManager.isEnabled":!0}),model=$(go.GraphLinksModel);model.nodeDataArray=[{key:1,loc:"120 120",text:"► q1",entry:!0},{key:2,text:"q2",loc:"323.00000000000006 91.99999999999999"},{key:3,text:"q3",loc:"493.00000000000045 46.999999999999986"},{key:4,text:"q4 †",loc:"657.0000000000002 112.99999999999999",accept:!0}],model.linkDataArray=[{from:1,to:2,text:"a",points:[179.06728943601135,139.8154328922902,225.64836444626968,122.78303707981034,273.65543967653645,116.15055207972091,323.10973820912494,119.91504578723732]},{from:2,to:3,text:"b",points:[380.0925955921527,107.56400791134979,415.04877728172323,87.46606196537267,452.6792938693899,77.51895409580794,493.00078114367346,77.71828686148507]},{from:3,to:4,text:"a",points:[553.6026325794317,82.40729169580716,593.5457486376579,87.74662980838917,629.9780938022612,101.99615189908398,662.673922113945,125.78232925027875]},{from:2,to:2,points:[368.75,148.91377481542537,389.75,185.2868417743718,317.25,185.2868417743718,338.25,148.91377481542537],text:"a"},{from:3,to:3,points:[538.75,103.91377481542537,559.75,140.2868417743718,487.25,140.2868417743718,508.25,103.91377481542537],text:"a"}],myDiagram.model=model;var keyManage=myDiagram.nodes.count;myDiagram.addDiagramListener("Modified",function(t){var e=document.getElementById("SaveButton");e&&(e.disabled=!myDiagram.isModified);var a=document.title.indexOf("*");myDiagram.isModified?a<0&&(document.title+="*"):a>=0&&(document.title=document.title.substr(0,a))}),myDiagram.nodeTemplate=$(go.Node,"Auto",new go.Binding("location","loc",go.Point.parse).makeTwoWay(go.Point.stringify),$(go.Shape,"circle",{width:60,height:60,parameter1:40,fill:$(go.Brush,"Linear",{0:"rgb(51, 122, 183)",1:"rgb(33, 97, 152)"}),stroke:null,portId:"",fromLinkable:!0,fromLinkableSelfNode:!0,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!0,cursor:"pointer"}),$(go.TextBlock,{font:"bold 11pt helvetica, bold arial, sans-serif",stroke:"white",editable:!1},new go.Binding("text").makeTwoWay())),myDiagram.nodeTemplate.selectionAdornmentTemplate=$(go.Adornment,"Spot",$(go.Panel,"Auto",$(go.Shape,{fill:null,stroke:"gray",strokeWidth:2}),$(go.Placeholder)),$("Button",{alignment:go.Spot.TopRight,click:addNodeAndLink},$(go.Shape,"ACvoltageSource",{width:10,height:10,stroke:"red"})),$("Button",{alignment:go.Spot.LeftCenter,click:setEntryNode},$(go.Shape,"TriangleRight",{width:10,height:10})),$("Button",{alignment:go.Spot.BottomCenter,click:setAcceptNode},$(go.Shape,"PlusLine",{width:10,height:10}))),myDiagram.linkTemplate=$(go.Link,{curve:go.Link.Bezier,adjusting:go.Link.Stretch,reshapable:!0,relinkableFrom:!0,relinkableTo:!0,toShortLength:3},new go.Binding("points").makeTwoWay(),new go.Binding("curviness"),$(go.Shape,{strokeWidth:1.5}),$(go.Shape,{toArrow:"standard",stroke:null}),$(go.Panel,"Auto",$(go.Shape,{fill:$(go.Brush,"Radial",{0:"rgb(240, 240, 240)",.3:"rgb(240, 240, 240)",1:"rgba(240, 240, 240, 0)"}),stroke:null}),$(go.TextBlock,"?",{textAlign:"center",font:"9pt helvetica, arial, sans-serif",margin:4,editable:!0},new go.Binding("text").makeTwoWay()))),load();var _createClass=function(){function t(t,e){for(var a=0;a<e.length;a++){var o=e[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,a,o){return a&&t(e.prototype,a),o&&t(e,o),e}}(),Nodos=function(){function t(e,a,o,n){_classCallCheck(this,t),this.key=e,this.text=a,this.entry=o,this.accept=n,this.enlaces=[]}return _createClass(t,[{key:"addEnlace",value:function(t){this.enlaces.push(t)}}]),t}(),Enlaces=function t(e,a,o){_classCallCheck(this,t),this.from=e,this.to=a,this.text=o},_createClass=function(){function t(t,e){for(var a=0;a<e.length;a++){var o=e[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,a,o){return a&&t(e.prototype,a),o&&t(e,o),e}}(),JQ=jQuery;JQ.noConflict(),JQ(document).ready(function(){var t,e=JQ("#inputField"),a=JQ(".count"),o=JQ("#wordsCount");o.css("opacity",0),e.on("input",function(){if(JQ(this).val().length>0){1==JQ(this).val().length&&o.css("opacity",1);t=JQ(this).val().replace(" ","").split(","),a.html(t.length)}else o.css("opacity",0)}),e.keypress(function(a){13==a.which&&(""!=e.val()?run(t):(output.clear(),output.showError("Input field is empty.")))}),JQ("#run").on("click",function(){""!=e.val()?run(t):(output.clear(),output.showError("Input field is empty."))})});var OutputCtrl=function(){function t(){_classCallCheck(this,t),this.outputField=JQ("#output")}return _createClass(t,[{key:"clear",value:function(){this.outputField.html("")}},{key:"addLine",value:function(t){this.outputField.append("<li><span class='text-default'>"+t+"</span></li>")}},{key:"addWord",value:function(t,e,a){e?this.outputField.append("<li title='"+a+"'><span class='text-success'>"+t+" <span class='glyphicon glyphicon-ok' aria-hidden='true'></span></span></li>"):this.outputField.append("<li><span class='text-danger'>"+t+" <span class='glyphicon glyphicon-remove' aria-hidden='true'></span></span></li>")}},{key:"showError",value:function(t){this.outputField.append("<li><span class='text-danger'><strong>ERROR: </strong>"+t+"</span></li>")}}]),t}(),output=new OutputCtrl;